## 使用深度摄像头实现循迹和踢球
### 实训背景
在自动化巡检领域，特别是面对复杂的工业环境时，机械狗的稳定性和适应性至关重要。通过循迹技术，机械狗可以实时调整其运动姿态，确保巡检任务的精确执行。结合深度摄像头，机械狗不仅能识别环境中的白线，还可以通过交叉路口的检测进行路径规划。同时，为了增强机械狗的互动能力，加入目标检测与互动功能（如踢球）可以使其在更广泛的应用场景中表现出色。
### 实训内容
本次实训旨在使用深度摄像头实现以下功能：
- 循迹：利用深度摄像头识别地面的白线，指导机械狗沿白线前进，并能够识别并正确通过交叉路口。
- 目标检测：检测视野内的特定目标（如球），并执行相应的动作（如踢球）。
### 实训目的及要求
#### 目的
- 掌握利用深度摄像头进行白线检测和循迹算法的实现。
- 掌握使用简单我目标检测算法
- 提升对自动化巡检的实际操作能力。
#### 要求
- 实现机械狗循白线前进的功能，能够稳定沿白线移动，并在偏离时进行及时纠正。
- 实现机械狗识别交叉白线并作出相应路径规划，确保正确通过交叉路口。
- 实现机械狗识别视野内的球并采取相应动作，最终将球踢出。
### 实验软硬件环境
硬件：绝影lite2
软件：
- python 3.7
- opencv-python 4.7
- numpy

### 实训操作指南
1. 按照官方提供的步骤，编译opencv源码
`https://github.com/OpenCVChina/DeepRobotDog?tab=readme-ov-file`
编译过程中
`-D PYTHON3_LIBRARY=/usr/lib/aarch64-linux-gnu/libpython3.6m.so`
`-D PYTHON3_INCLUDE_DIR=/usr/include/python3.6m`
两项可以更换为对应虚拟环境的`python`路径及`python库`路径

2. 实现白线检测
> 白线检测要实现的效果是定位视野内哪些区域存在白线，因此选择对视野进行划分区域检测，有白线的区域标记为1，即可识别白线的分布状态，进而判断是直线还是交叉路口。逻辑实现参考代码`trailing.py`中的`Check_Line`
> 白线检测时，在视野中画了五个框，检测的返回值为五位二进制数，我们可以使用如下的判断进行循迹矫正
> ```python
result_ckl = Check_Line(real_img)
if result_ckl == 4:
    print("jiuzheng")
    break
elif result_ckl == 3 or result_ckl == 1 or result_ckl == 2 or result_ckl == 6:
    print("线在视野右侧，机械狗偏左")
elif result_ckl == 24 or result_ckl == 16 or result_ckl == 8 or result_ckl == 12:
    print("线在视野左侧，机械狗偏右")
> ```
> 除上述状态外，返回值为`31`时即为十字路，返回值为`7`或`15`时即为右转或右丁字路，返回值为`28`或`30`时即为左转或左丁字路

3. 实现踢球
> 与白线检测是原理类似，同样是在视野内划分区域，对每一个区域进行颜色检测，判断球在视野内哪个区域，代码参考`trailing.py`中的`Check_Ball2`
> 针对球在视野的不同区域采取不同的行动策略，最终将球的位置锚定到视野的右侧，进行冲刺踢球
> 

4. 踢球结束后，再次回归巡线状态，进行下一轮的判断

### 参考

[GitHub](https://github.com/Jadeble/sizutrain)